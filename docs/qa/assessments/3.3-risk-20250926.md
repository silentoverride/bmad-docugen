# Risk Profile: Story 3.3

Date: 2025-09-26
Reviewer: Quinn (Test Architect)

## Executive Summary

- Total Risks Identified: 5
- Critical Risks: 1
- High Risks: 3
- Risk Score: 44/100

Signed bundle packaging underpins trust for downstream integrators. Any compromise in signing or delivery controls immediately undermines DocuGen’s credibility. The most acute risk is invalid or weak signature enforcement.

## Critical Risks Requiring Immediate Attention

### 1. SEC-010: Bundle Signing Keys Compromised or Improperly Applied
**Score:** 9 (Critical)

- **Probability:** High (3) – Packaging introduces new signing workflows that can expose keys or skip verification due to performance shortcuts.
- **Impact:** High (3) – Recipients cannot trust artefacts; potential tampering leads to compliance breaches.
- **Mitigation:**
  - Store signing keys in HSM/KMS with role-based access; enforce signing through managed service.
  - Validate signatures immediately after packaging; fail pipeline on mismatch.
  - Log every signing action with audit metadata and monitor anomalies.
- **Testing Focus:** Security integration tests, penetration tests targeting signing pipeline, signature verification automation.

## High-Risk Items

### 2. DATA-012: Packaging Omits Critical Artefacts or Metadata
**Score:** 6 (High)

- **Probability:** Medium (2) – As artefact list evolves, packaging scripts may not keep pace.
- **Impact:** High (3) – Missing reconciliation reports/checksums prevents compliance validation.
- **Mitigation:**
  - Maintain manifest of required artefacts validated via automated tests.
  - Implement contract tests ensuring bundle contents match specification (PDFs, manifests, reports, checksums).
  - Include consumer contract tests verifying availability post-delivery.
- **Testing Focus:** Integration tests asserting archive content; regression tests as artefact schema evolves.

### 3. OPS-013: Delivery Endpoint Misconfigures Expiry and Access Controls
**Score:** 6 (High)

- **Probability:** Medium (2) – Pre-signed URLs and webhooks often default to permissive TTLs or roles.
- **Impact:** High (3) – Artefacts stay accessible beyond policy windows or are leaked to unauthorised parties.
- **Mitigation:**
  - Enforce short-lived URLs with rotation; require OAuth-signed webhook registrations.
  - Monitor download attempts and expire links upon retrieval or after SLA.
  - Provide admin tooling to revoke links on demand.
- **Testing Focus:** Integration tests verifying TTL expiry, revocation, and access logging.

### 4. PERF-009: Packaging SLA (>30s) Breached Under Sequential Runs
**Score:** 6 (High)

- **Probability:** Medium (2) – Compression, signing, and checksum calculation can be heavy.
- **Impact:** High (3) – Downstream automation stalls, partners perceive DocuGen as slow.
- **Mitigation:**
  - Profile pipeline; parallelise compression vs metadata generation.
  - Cache static assets (e.g., docs) to avoid recomputation.
  - Monitor SLA metrics and auto-scale packaging workers if thresholds breached.
- **Testing Focus:** Performance benchmarking with sequential workloads; monitoring in staging.

## Medium-Risk Items

### 5. BUS-008: Partner Verification Script Falls Out of Sync
**Score:** 4 (Medium)

- **Probability:** Medium (2) – Script updates may lag packaging changes.
- **Impact:** Medium (2) – Partners fail verification, raising support load and eroding trust.
- **Mitigation:**
  - Version verification script alongside packaging changes; include automated tests comparing outputs.
  - Communicate updates via release notes and partner portal.
  - Provide backward compatibility or deprecation schedule.
- **Testing Focus:** Integration tests running script against current bundles; documentation review.

## Risk Distribution

### By Category
- Security: 1 risk (1 critical)
- Data: 1 risk (0 critical, 1 high)
- Operational: 1 risk (0 critical, 1 high)
- Performance: 1 risk (0 critical, 1 high)
- Business: 1 risk (0 critical, 0 high, 1 medium)

### By Component
- Signing pipeline: 1 risk
- Packaging manifest: 1 risk
- Delivery endpoint: 1 risk
- Performance/SLA: 1 risk
- Partner tooling: 1 risk

## Risk Matrix

| Risk ID  | Description                                            | Probability | Impact | Score | Priority |
|----------|--------------------------------------------------------|-------------|--------|-------|----------|
| SEC-010  | Bundle signing keys compromised or applied incorrectly | High (3)    | High (3) | 9   | Critical |
| DATA-012 | Packaging omits critical artefacts or metadata         | Medium (2)  | High (3) | 6   | High     |
| OPS-013  | Delivery endpoint misconfigures expiry/access controls | Medium (2)  | High (3) | 6   | High     |
| PERF-009 | Packaging SLA breached under sequential runs           | Medium (2)  | High (3) | 6   | High     |
| BUS-008  | Partner verification script falls out of sync          | Medium (2)  | Medium (2) | 4 | Medium   |

## Detailed Risk Register

| Risk ID  | Category | Components Affected                    | Detection Method                               | Mitigation Owner      | Residual Risk |
|----------|----------|----------------------------------------|-----------------------------------------------|-----------------------|----------------|
| SEC-010  | Security | Signing service, key management        | Security tests, audit logs, key rotation checks| Security Engineering  | Low with HSM + monitoring |
| DATA-012 | Data     | Packaging manifest, archive builder    | Archive validation tests, schema diff checks   | Platform Engineering  | Medium – requires ongoing alignment |
| OPS-013  | Operational | Delivery API, webhook infrastructure | TTL tests, access log audits                   | Platform Ops          | Medium – dependent on config vigilance |
| PERF-009 | Performance | Packaging workers, queues            | Performance benchmarks, SLA dashboards         | Platform Engineering  | Medium – scaling to be maintained |
| BUS-008  | Business | Partner tooling, documentation         | Script integration tests, partner feedback     | Partner Success       | Low with versioned releases |

## Risk-Based Testing Strategy

### Priority 1: Critical & High Risks
- Security validation of signing workflow (SEC-010).
- Archive content contract tests and delivery endpoint TTL checks (DATA-012, OPS-013).
- Performance benchmarks for packaging throughput (PERF-009).

### Priority 2: Medium Risks
- Automated runs of partner verification script against latest bundles (BUS-008).

### Priority 3: Baseline Regression
- Smoke tests ensuring webhook notifications fire with correct metadata.
- Monitoring checks verifying download logging and signature validation outputs.

## Risk Acceptance Criteria

### Must Fix Before Production
- SEC-010 safeguards must be validated with penetration testing and monitoring.
- DATA-012/OPS-013 controls must confirm complete bundle contents and secure delivery.

### Can Deploy with Mitigation
- PERF-009 acceptable if SLA dashboards and autoscaling policies are in place.
- BUS-008 acceptable with versioned script releases and communication plan.

### Accepted Risks
- None accepted currently.

## Monitoring Requirements
- Track signature validation failures, delivery access attempts, and packaging runtime metrics.
- Monitor partner verification error rates and feedback channels.

## Risk Review Triggers
- Changes to bundle composition or delivery infrastructure.
- Signing key rotation events or incidents.
- New partner onboarding feedback referencing verification steps.

## Recommendations Summary
- Harden signing pipeline within KMS/HSM boundaries and verify every bundle.
- Keep packaging manifests and delivery expiries governed by automated tests and monitoring.
- Maintain partner tooling in lockstep with packaging evolution to sustain trust.

Risk profile: docs/qa/assessments/3.3-risk-20250926.md
