# Risk Profile: Story 4.3

Date: 2025-09-26
Reviewer: Quinn (Test Architect)

## Executive Summary

- Total Risks Identified: 5
- Critical Risks: 1
- High Risks: 3
- Risk Score: 44/100

Preview mode enables sandboxed template validation. If isolation fails, preview executions can pollute production manifests or skip compliance checks, undermining governance.

## Critical Risks Requiring Immediate Attention

### 1. OPS-019: Preview Runs Write to Production Manifests or Storage
**Score:** 9 (Critical)

- **Probability:** High (3) – Preview shares workers and orchestration with production; misconfigured storage paths are common during rollout.
- **Impact:** High (3) – Experimental templates leak into production bundles, breaking compliance and confusing auditors.
- **Mitigation:**
  - Enforce dedicated storage namespaces and manifest prefixes for preview; block promotion when preview flag detected.
  - Add guardrails preventing preview flag removal without code review.
  - Monitor for preview artefacts appearing in production buckets with alerts.
- **Testing Focus:** Integration tests verifying storage segregation; chaos tests attempting to route preview outputs to production paths.

## High-Risk Items

### 2. DATA-018: Preview Validation Skips Compliance & Reconciliation Checks
**Score:** 6 (High)

- **Probability:** Medium (2) – Engineers may disable checks for speed during preview iteration.
- **Impact:** High (3) – Templates appear valid despite violating responsible lending rules.
- **Mitigation:**
  - Mirror full validation stack in preview with explicit toggles documented; require compliance sign-off for any skipped checks.
  - Include automated tests ensuring preview mode triggers reconciliation and rule diagnostics.
  - Surface validation coverage status in UI/CLI output.
- **Testing Focus:** Integration tests verifying diagnostics run; coverage reports for preview validations.

### 3. SEC-014: Preview Artefacts Expose Unreviewed Templates to Broader Audience
**Score:** 6 (High)

- **Probability:** Medium (2) – Preview artefacts may be accessible to operators lacking proper clearance.
- **Impact:** High (3) – Unapproved content leaks to partners or compliance users, risking confusion or IP exposure.
- **Mitigation:**
  - Restrict preview artefact access via RBAC; require explicit preview roles.
  - Audit access logs and send alerts on cross-role retrieval attempts.
  - Provide link expiration and watermarking on preview outputs.
- **Testing Focus:** Security tests covering access control; log audits for preview retrievals.

### 4. PERF-013: Preview Mode Overloads Rendering Infrastructure
**Score:** 6 (High)

- **Probability:** Medium (2) – Concurrent preview experiments may saturate workers intended for production jobs.
- **Impact:** High (3) – Production SLAs degrade, affecting bundle delivery.
- **Mitigation:**
  - Allocate dedicated worker pool or enforce quotas for preview runs.
  - Monitor resource usage; throttle preview when production queue grows.
  - Communicate scheduling guidelines to template authors.
- **Testing Focus:** Load tests simulating concurrent preview + production runs; monitoring of queue metrics.

## Medium-Risk Items

### 5. BUS-014: Stakeholder Review Lacks Traceability for Preview Sign-Off
**Score:** 4 (Medium)

- **Probability:** Medium (2) – Review workflows may rely on ad-hoc communication.
- **Impact:** Medium (2) – Disputes arise over readiness; auditors lack evidence of approval.
- **Mitigation:**
  - Capture review decisions within admin UI with manifest references.
  - Integrate with compliance evidence store, including timestamps and reviewer roles.
  - Provide dashboards tracking preview status and pending approvals.
- **Testing Focus:** UI tests ensuring review state persists; evidence export validation.

## Risk Distribution

### By Category
- Operational: 2 risks (1 critical, 1 high)
- Data: 1 risk (0 critical, 1 high)
- Security: 1 risk (0 critical, 1 high)
- Performance: 1 risk (0 critical, 1 high)
- Business: 1 risk (0 critical, 0 high, 1 medium)

### By Component
- Storage segregation: 1 risk
- Validation pipeline: 1 risk
- Access control: 1 risk
- Worker capacity: 1 risk
- Review workflow: 1 risk

## Risk Matrix

| Risk ID  | Description                                           | Probability | Impact | Score | Priority |
|----------|-------------------------------------------------------|-------------|--------|-------|----------|
| OPS-019  | Preview runs write to production manifests/storage     | High (3)    | High (3) | 9   | Critical |
| DATA-018 | Preview validation skips compliance/reconciliation     | Medium (2)  | High (3) | 6   | High     |
| SEC-014  | Preview artefacts accessible without clearance         | Medium (2)  | High (3) | 6   | High     |
| PERF-013 | Preview mode overloads rendering infrastructure        | Medium (2)  | High (3) | 6   | High     |
| BUS-014  | Stakeholder review lacks traceability                  | Medium (2)  | Medium (2) | 4 | Medium   |

## Detailed Risk Register

| Risk ID  | Category | Components Affected                   | Detection Method                                | Mitigation Owner      | Residual Risk |
|----------|----------|---------------------------------------|-------------------------------------------------|-----------------------|----------------|
| OPS-019  | Operational | Storage namespaces, orchestration  | Integration tests, monitoring alerts            | Platform Ops          | Medium – requires constant monitoring |
| DATA-018 | Data     | Validation engine, CLI/UI preview     | Contract tests, coverage reporting              | Compliance Engineering | Medium – dependent on governance |
| SEC-014  | Security | RBAC, storage permissions             | Access audits, penetration tests                | Security Engineering  | Medium – needs periodic review |
| PERF-013 | Performance | Worker pools, queue management     | Load testing, queue metrics dashboards          | Platform Engineering  | Medium – relies on quotas |
| BUS-014  | Business | Review UI, evidence workflows         | UI tests, evidence export validation            | Compliance Operations | Low with workflow tooling |

## Risk-Based Testing Strategy

### Priority 1: Critical & High Risks
- Storage segregation tests and monitoring for preview artefacts (OPS-019).
- Validation coverage tests ensuring compliance checks run in preview (DATA-018).
- Access control and load tests covering preview infrastructure (SEC-014, PERF-013).

### Priority 2: Medium Risks
- Review workflow UI tests and evidence export checks (BUS-014).

### Priority 3: Baseline Regression
- Smoke tests executing preview commands end-to-end, verifying isolation, diagnostics, and UI surfacing.

## Risk Acceptance Criteria

### Must Fix Before Production
- OPS-019 controls must guarantee preview never touches production storage.
- DATA-018/SEC-014 must show compliance validation and RBAC are enforced in preview.

### Can Deploy with Mitigation
- PERF-013 acceptable with quotas, monitoring, and throttling.
- BUS-014 acceptable when approval workflow backlog is tracked.

### Accepted Risks
- None accepted currently.

## Monitoring Requirements
- Track preview vs production storage usage, validation coverage metrics, and access logs.
- Monitor worker utilisation and queue delays attributable to preview traffic.

## Risk Review Triggers
- New template types or validation rules added to preview.
- Infrastructure scaling changes or shared worker adjustments.
- Compliance audit findings referencing preview governance.

## Recommendations Summary
- Isolate preview storage rigorously and verify via automation.
- Run full compliance checks in preview to mirror production behaviour.
- Control access, resource usage, and review traceability to maintain governance.

Risk profile: docs/qa/assessments/4.3-risk-20250926.md
