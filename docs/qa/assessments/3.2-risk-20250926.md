# Risk Profile: Story 3.2

Date: 2025-09-26
Reviewer: Quinn (Test Architect)

## Executive Summary

- Total Risks Identified: 5
- Critical Risks: 1
- High Risks: 3
- Risk Score: 43/100

This story anchors DocuGen’s auditability. Failure to secure storage or maintain immutable logs would nullify compliance claims and obstruct investigations. The dominant threat is misconfigured encryption/retention on manifests and bundles.

## Critical Risks Requiring Immediate Attention

### 1. SEC-009: Encrypted Storage Misconfiguration Exposes Manifests
**Score:** 9 (Critical)

- **Probability:** High (3) – Multi-account S3/KMS setups are error-prone, especially during initial bootstrap.
- **Impact:** High (3) – Compromised artefacts reveal sensitive financial data, triggering major compliance incidents.
- **Mitigation:**
  - Enforce KMS policies with required encryption context and bucket policies that deny unencrypted uploads.
  - Automate compliance checks (e.g., AWS Config rules) blocking misconfigured resources.
  - Perform penetration testing and access reviews before promotion.
- **Testing Focus:** Automated security scans, penetration tests on storage endpoints.

## High-Risk Items

### 2. DATA-011: Integrity Hash Verification Not Enforced on Retrieval
**Score:** 6 (High)

- **Probability:** Medium (2) – Retrieval paths may skip hash re-validation due to performance concerns.
- **Impact:** High (3) – Corrupted artefacts go undetected, invalidating evidence trails.
- **Mitigation:**
  - Require hash verification in all retrieval APIs/CLI commands with failure alerts.
  - Log verification outcomes with trace IDs for audit.
  - Include automated tests comparing stored vs recalculated hashes.
- **Testing Focus:** Integration tests retrieving artefacts with tampered payloads; CLI contract tests.

### 3. OPS-011: Access Logging Lacks Operator Identity & Traceability
**Score:** 6 (High)

- **Probability:** Medium (2) – Storage logs often miss user context unless explicitly wired.
- **Impact:** High (3) – Auditors cannot trace evidence access, increasing breach suspicion.
- **Mitigation:**
  - Route downloads through gateway service injecting operator identity into structured logs.
  - Enforce log schema with correlation IDs linking to manifests.
  - Add monitoring for anonymous access attempts.
- **Testing Focus:** Integration tests verifying log entries for downloads; audit sampling scripts.

### 4. OPS-012: Disaster Recovery Runbooks Untested or Stale
**Score:** 6 (High)

- **Probability:** Medium (2) – Tabletop exercises slip without enforcement.
- **Impact:** High (3) – Real incidents see prolonged downtime or data loss, breaching compliance commitments.
- **Mitigation:**
  - Schedule quarterly DR drills with evidence capture.
  - Track runbook updates in version control with review sign-off.
  - Tie promotion pipeline to latest DR validation timestamp.
- **Testing Focus:** Simulated failover tests; review of runbook change logs.

## Medium-Risk Items

### 5. PERF-008: Logging Pipeline Overwhelms Observability Stack
**Score:** 4 (Medium)

- **Probability:** Medium (2) – High-volume structured logs may exceed quotas.
- **Impact:** Medium (2) – Dropped logs hinder investigations and increase operational toil.
- **Mitigation:**
  - Implement sampling or tiered retention; monitor ingestion lag.
  - Scale log storage via managed services with alerting on backlog.
  - Document retention trade-offs with compliance buy-in.
- **Testing Focus:** Load tests on logging pipelines; monitoring of ingestion metrics.

## Risk Distribution

### By Category
- Security: 1 risk (1 critical)
- Data: 1 risk (0 critical, 1 high)
- Operational: 2 risks (0 critical, 2 high)
- Performance: 1 risk (0 critical, 0 high, 1 medium)
- Business/Technical: 0 additional risks

### By Component
- Storage/KMS: 1 risk
- Integrity verification: 1 risk
- Access logging: 1 risk
- DR runbooks: 1 risk
- Logging pipeline capacity: 1 risk

## Risk Matrix

| Risk ID  | Description                                           | Probability | Impact | Score | Priority |
|----------|-------------------------------------------------------|-------------|--------|-------|----------|
| SEC-009  | Encrypted storage misconfiguration exposes manifests   | High (3)    | High (3) | 9   | Critical |
| DATA-011 | Integrity hash verification not enforced on retrieval | Medium (2)  | High (3) | 6   | High     |
| OPS-011  | Access logging lacks operator identity                | Medium (2)  | High (3) | 6   | High     |
| OPS-012  | Disaster recovery runbooks untested or stale          | Medium (2)  | High (3) | 6   | High     |
| PERF-008 | Logging pipeline overwhelms observability stack       | Medium (2)  | Medium (2) | 4 | Medium   |

## Detailed Risk Register

| Risk ID  | Category | Components Affected                    | Detection Method                              | Mitigation Owner      | Residual Risk |
|----------|----------|----------------------------------------|-----------------------------------------------|-----------------------|----------------|
| SEC-009  | Security | S3 buckets, KMS keys                   | Security scans, AWS Config, penetration tests | Security Engineering  | Low with automated guardrails |
| DATA-011 | Data     | Retrieval APIs, CLI validation         | Integration tests, hash verification logs     | Platform Engineering  | Medium – requires ongoing checks |
| OPS-011  | Operational | Download gateway, logging pipeline | Log audits, monitoring alerts                 | Compliance Ops        | Medium – needs continuous monitoring |
| OPS-012  | Operational | DR runbooks, infrastructure IaC     | Tabletop drills, runbook reviews              | SRE                   | Medium – dependent on drill cadence |
| PERF-008 | Performance | Logging/observability stack         | Load testing, ingestion dashboards            | SRE                   | Low with capacity management |

## Risk-Based Testing Strategy

### Priority 1: Critical & High Risks
- Automated storage compliance scans and penetration tests (SEC-009).
- Retrieval integrity validation tests (DATA-011).
- Logging verification and DR drill rehearsals (OPS-011, OPS-012).

### Priority 2: Medium Risks
- Load testing observability stack and monitoring ingestion metrics (PERF-008).

### Priority 3: Baseline Regression
- Smoke tests verifying trace IDs across logs.
- CLI tests ensuring download commands enforce hash checks.

## Risk Acceptance Criteria

### Must Fix Before Production
- SEC-009 controls must be validated via automated checks and audits.
- DATA-011 and OPS-011 mitigations need to be operational with monitoring in place.

### Can Deploy with Mitigation
- OPS-012 acceptable if DR drill schedule is approved and tracked.
- PERF-008 acceptable with observability capacity plan and alerts configured.

### Accepted Risks
- None accepted currently.

## Monitoring Requirements
- Monitor encryption status changes, access log completeness, and hash verification failures.
- Track DR drill outcomes and log ingestion metrics with alert thresholds.

## Risk Review Triggers
- Storage architecture changes (new buckets, regions).
- Introduction of new artefact types or retention policies.
- Findings from compliance or security audits referencing logging/DR gaps.

## Recommendations Summary
- Automate storage security enforcement and validation.
- Ensure every retrieval validates integrity and is fully logged.
- Institutionalise DR exercises and monitor logging pipeline health.

Risk profile: docs/qa/assessments/3.2-risk-20250926.md
