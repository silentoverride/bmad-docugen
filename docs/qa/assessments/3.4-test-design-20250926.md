# Test Design: Story 3.4

Date: 2025-09-26
Designer: Quinn (Test Architect)

## Test Strategy Overview

- Total test scenarios: 9
- Unit tests: 2 (22.2%)
- Integration tests: 6 (66.7%)
- E2E tests: 1 (11.1%)
- Priority distribution: P0: 7, P1: 2, P2: 0

## Test Scenarios by Acceptance Criteria

### AC1: Dashboard visualises throughput, failure rates, rule violations, and pixel diff metrics in near real-time.

#### Scenarios

| ID           | Level       | Priority | Test                                                                                        | Justification                                                                                       |
| ------------ | ----------- | -------- | ------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------- |
| 3.4-UNIT-001 | Unit        | P0       | Metric exporter enforces label schema (manifest id, environment, metric type)              | Prevents DATA-013 by ensuring traceable metrics.                                                    |
| 3.4-INT-001  | Integration | P0       | Synthetic run populates dashboard panels verifying throughput/failure/violation visualisation | Confirms data flow from pipeline to Grafana with correct mapping.                                   |
| 3.4-INT-002  | Integration | P1       | Dashboard snapshot test asserts layout + filters exist for each metric group                | Medium risk ensures front-end view remains usable.                                                  |

### AC2: Alerting policies trigger when duration, failure rate, or fidelity metrics breach thresholds.

#### Scenarios

| ID           | Level       | Priority | Test                                                                                  | Justification                                                                                              |
| ------------ | ----------- | -------- | ------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------- |
| 3.4-INT-003  | Integration | P0       | Synthetic breach test triggers duration alert and validates routing/escalation         | Direct mitigation for OPS-014; ensures alerts fire for SLA violations.                                    |
| 3.4-INT-004  | Integration | P0       | Simulated fidelity regression triggers alert with diff artefact link                   | Ensures compliance metrics produce actionable alerts.                                                     |

### AC3: Dashboard links into run manifests for deep-dive investigation in a single click.

#### Scenarios

| ID           | Level       | Priority | Test                                                                                   | Justification                                                                                             |
| ------------ | ----------- | -------- | -------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------- |
| 3.4-INT-005  | Integration | P0       | Dashboard link test ensures clicking metric opens manifest detail view with correct ID | Prevents investigative dead ends; mitigates DATA-013/TECH-011 drift.                                     |
| 3.4-E2E-001  | E2E         | P0       | Operator workflow from alert to dashboard to manifest verifies investigation path      | Confirms real-world usability of observability stack.                                                     |

### AC4: Runbook documents remediation steps for top five failure modes and is tested via quarterly drills.

#### Scenarios

| ID           | Level       | Priority | Test                                                                                           | Justification                                                                                      |
| ------------ | ----------- | -------- | ---------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------- |
| 3.4-UNIT-002 | Unit        | P1       | Documentation check ensures runbook includes failure modes, SLAs, and escalation contacts      | Medium risk to maintain doc completeness.                                                          |
| 3.4-INT-006  | Integration | P0       | Game day simulation triggers alert, follows runbook steps, and captures evidence for audit     | Mitigates BUS-009 by ensuring procedures validated.                                                |

## Risk Coverage

- OPS-014 covered via synthetic alert tests and game day simulation.
- DATA-013/TECH-011 mitigated by metric schema unit test, dashboard link verification, and snapshot gating.
- PERF-010 addressed through synthetic load and dashboard ingestion checks.
- BUS-009 mitigated by runbook validation scenario.

## Recommended Execution Order

1. P0 unit test (3.4-UNIT-001)
2. P0 integration tests (3.4-INT-001, 3.4-INT-003, 3.4-INT-004, 3.4-INT-005, 3.4-INT-006)
3. P0 E2E test (3.4-E2E-001)
4. P1 tests (3.4-INT-002, 3.4-UNIT-002)

## Quality Checklist

- [x] Every AC has test coverage
- [x] Test levels are appropriate (not over-testing)
- [x] No duplicate coverage across levels
- [x] Priorities align with business risk
- [x] Test IDs follow naming convention
- [x] Scenarios are atomic and independent
