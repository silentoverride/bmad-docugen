# Test Design: Story 5.3

Date: 2025-09-26
Designer: Quinn (Test Architect)

## Test Strategy Overview

- Total test scenarios: 9
- Unit tests: 3 (33.3%)
- Integration tests: 5 (55.6%)
- E2E tests: 1 (11.1%)
- Priority distribution: P0: 7, P1: 2, P2: 0

## Test Scenarios by Acceptance Criteria

### AC1: Admin UI ships compliance dashboard summarising rule pass/fail trends, waiver counts, and time-to-resolution metrics.

#### Scenarios

| ID           | Level       | Priority | Test                                                                                      | Justification                                                                                               |
| ------------ | ----------- | -------- | ----------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------- |
| 5.3-UNIT-001 | Unit        | P0       | Dashboard data service calculates KPIs with manifest + waiver references                  | Ensures accuracy and mitigates DATA-022.                                                                    |
| 5.3-INT-001  | Integration | P0       | Dashboard rendering test ensures role-based user sees correct KPIs and filters            | Confirms UI surfaces required metrics for compliance stakeholders.                                         |
| 5.3-INT-002  | Integration | P1       | Snapshot comparison validates dashboard layout and accessibility features                 | Medium risk to maintain UX consistency.                                                                     |

### AC2: Prometheus/Grafana dashboards visualise compliance KPIs and feed alert thresholds for sustained failures.

#### Scenarios

| ID           | Level       | Priority | Test                                                                                            | Justification                                                                                                 |
| ------------ | ----------- | -------- | ----------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------- |
| 5.3-UNIT-002 | Unit        | P0       | Metric exporter ensures labels include waiver id, manifest id, severity, and environment       | Maintains traceability to mitigate DATA-022.                                                                    |
| 5.3-INT-003  | Integration | P0       | Synthetic KPI breach triggers alert routed to compliance on-call with deduplication           | Addresses OPS-023 to prevent alert fatigue yet ensure coverage.                                               |

### AC3: Dashboard tiles link to evidence bundles and manifests for drill-down investigations.

#### Scenarios

| ID           | Level       | Priority | Test                                                                                     | Justification                                                                                               |
| ------------ | ----------- | -------- | ---------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------- |
| 5.3-INT-004  | Integration | P0       | Tile link test ensures clicking KPI opens evidence bundle manifest view with RBAC check | Ensures TECH-017 coverage and security access enforcement.                                                 |
| 5.3-E2E-001  | E2E         | P0       | Investigative workflow from alert → dashboard → evidence download validates drill-down path | Provides end-to-end assurance for compliance teams.                                                         |

### AC4: Access control ensures only authorised compliance roles can view sensitive metrics and waive findings.

#### Scenarios

| ID           | Level       | Priority | Test                                                                                           | Justification                                                                                            |
| ------------ | ----------- | -------- | ---------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------- |
| 5.3-UNIT-003 | Unit        | P0       | RBAC policy unit test restricts dashboard + waiver actions to compliance scopes               | Direct mitigation for SEC-018.                                                                           |
| 5.3-INT-005  | Integration | P1       | Waiver workflow test ensures justification, approver, and expiry recorded and audited        | Medium risk ensures BUS-018 remains satisfied.                                                           |

## Risk Coverage

- SEC-018 addressed via RBAC policy unit test and investigative E2E workflow.
- DATA-022 mitigated by KPI calculations and metric label validation.
- TECH-017 covered by tile link integration test and E2E drill-down scenario.
- OPS-023 handled through alert synthetic tests and deduplication validation.
- BUS-018 satisfied via waiver workflow audit scenario.

## Recommended Execution Order

1. P0 unit tests (5.3-UNIT-001, 5.3-UNIT-002, 5.3-UNIT-003)
2. P0 integration tests (5.3-INT-001, 5.3-INT-003, 5.3-INT-004)
3. P0 E2E test (5.3-E2E-001)
4. P1 tests (5.3-INT-002, 5.3-INT-005)

## Quality Checklist

- [x] Every AC has test coverage
- [x] Test levels are appropriate (not over-testing)
- [x] No duplicate coverage across levels
- [x] Priorities align with business risk
- [x] Test IDs follow naming convention
- [x] Scenarios are atomic and independent
