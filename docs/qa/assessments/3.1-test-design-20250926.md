# Test Design: Story 3.1

Date: 2025-09-26
Designer: Quinn (Test Architect)

## Test Strategy Overview

- Total test scenarios: 9
- Unit tests: 3 (33.3%)
- Integration tests: 5 (55.6%)
- E2E tests: 1 (11.1%)
- Priority distribution: P0: 7, P1: 2, P2: 0

## Test Scenarios by Acceptance Criteria

### AC1: CLI and admin UI block progression past validation failures, presenting remediation guidance mapped to rule ids.

#### Scenarios

| ID           | Level       | Priority | Test                                                                                 | Justification                                                                                             |
| ------------ | ----------- | -------- | ------------------------------------------------------------------------------------ | --------------------------------------------------------------------------------------------------------- |
| 3.1-UNIT-001 | Unit        | P0       | Guidance renderer maps rule ids to remediation copy and documentation links         | Critical to ensure remediation clarity and mitigate DATA-010.                                             |
| 3.1-INT-001  | Integration | P0       | CLI failure path presents remediation guidance and blocks progression                | Ensures command-line users cannot bypass gating.                                                          |
| 3.1-INT-002  | Integration | P0       | Admin UI failure scenario displays same diagnostics and disables progression controls | Confirms parity across surfaces and prevents UI bypass.                                                   |

### AC2: Role-based access ensures only authorised operators can approve overrides with justification notes logged in manifests.

#### Scenarios

| ID           | Level       | Priority | Test                                                                                         | Justification                                                                                               |
| ------------ | ----------- | -------- | -------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------- |
| 3.1-UNIT-002 | Unit        | P0       | Override policy engine validates dual approval requirements and required fields              | Pure logic to prevent unauthorised override; mitigates SEC-008.                                            |
| 3.1-INT-003  | Integration | P0       | Valid override flow (dual authorisation) logs justification in manifest and audit trail      | Ensures governance requirements satisfied.                                                                 |
| 3.1-INT-004  | Integration | P0       | Invalid override attempt (insufficient scope) denied with audit log entry                    | Confirms RBAC enforcement preventing policy bypass.                                                        |

### AC3: Success path completes within five-minute operator target for seed scenarios, measured via telemetry.

#### Scenarios

| ID           | Level       | Priority | Test                                                                                           | Justification                                                                                           |
| ------------ | ----------- | -------- | ---------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------- |
| 3.1-INT-005  | Integration | P0       | Telemetry instrumentation emits start/stop events with manifest + operator identifiers         | Necessary to measure SLA and mitigate PERF-007.                                                         |
| 3.1-E2E-001  | E2E         | P1       | Timed operator journey (Playwright + telemetry capture) confirms completion under 5 minutes    | Confirms end-to-end performance target in realistic conditions.                                        |

### AC4: Training mode provides sample runs with annotated feedback for onboarding new operators.

#### Scenarios

| ID           | Level       | Priority | Test                                                                                       | Justification                                                                                               |
| ------------ | ----------- | -------- | ------------------------------------------------------------------------------------------ | ----------------------------------------------------------------------------------------------------------- |
| 3.1-UNIT-003 | Unit        | P1       | Training content generator produces annotated guidance referencing current rule catalog   | Medium risk ensures training materials stay aligned.                                                        |
| 3.1-INT-006  | Integration | P0       | Training mode execution path (CLI/UI) matches production gating logic and annotations      | Prevents OPS-010 drift by enforcing parity between training and production flows.                           |

## Risk Coverage

- SEC-008 addressed via override policy unit test plus valid/invalid override integration scenarios.
- DATA-010 mitigated by guidance renderer test and parity checks across CLI/UI.
- PERF-007 covered through telemetry instrumentation and timed E2E run.
- OPS-010 handled by training mode parity integration test.

## Recommended Execution Order

1. P0 unit tests (3.1-UNIT-001, 3.1-UNIT-002)
2. P0 integration tests (3.1-INT-001, 3.1-INT-002, 3.1-INT-003, 3.1-INT-004, 3.1-INT-005, 3.1-INT-006)
3. P1 tests (3.1-E2E-001, 3.1-UNIT-003)

## Quality Checklist

- [x] Every AC has test coverage
- [x] Test levels are appropriate (not over-testing)
- [x] No duplicate coverage across levels
- [x] Priorities align with business risk
- [x] Test IDs follow naming convention
- [x] Scenarios are atomic and independent
