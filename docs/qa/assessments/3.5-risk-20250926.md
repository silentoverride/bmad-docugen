# Risk Profile: Story 3.5

Date: 2025-09-26
Reviewer: Quinn (Test Architect)

## Executive Summary

- Total Risks Identified: 5
- Critical Risks: 1
- High Risks: 3
- Risk Score: 43/100

Secrets management is foundational for DocuGen’s security posture. The greatest exposure is storing service credentials outside of managed vault controls, which would violate compliance mandates and compromise external integrations.

## Critical Risks Requiring Immediate Attention

### 1. SEC-011: Secrets Persist Outside Managed Vault Controls
**Score:** 9 (Critical)

- **Probability:** High (3) – Migration from environment variables or static config frequently leaves residual secrets.
- **Impact:** High (3) – Credential leaks expose external APIs, signing keys, and storage access, causing severe security incidents.
- **Mitigation:**
  - Audit repos/CI for hard-coded secrets; enforce scanners in CI/CD and pre-commit.
  - Apply policy-as-code to block deployments referencing non-vault secret sources.
  - Rotate any exposed credentials immediately and capture remediation evidence.
- **Testing Focus:** Secret scanning automation, infrastructure policy tests, penetration testing on deployment pipelines.

## High-Risk Items

### 2. OPS-015: Rotation Pipelines Fail Silently
**Score:** 6 (High)

- **Probability:** Medium (2) – Automation scripts can fail due to permission drift or service outages.
- **Impact:** High (3) – Expired secrets cause outages or force risky manual hotfixes.
- **Mitigation:**
  - Instrument rotation jobs with health checks and alerts; require success artefacts stored for audits.
  - Test rotations in staging before prod; include automatic rollback.
  - Track rotation attempts with correlation IDs and failure analytics.
- **Testing Focus:** Chaos tests forcing rotation failures; monitoring verification.

### 3. DATA-014: Rotation Logs Leak Sensitive Metadata
**Score:** 6 (High)

- **Probability:** Medium (2) – Logging frameworks may output secret payloads or connection details.
- **Impact:** High (3) – Violates privacy/compliance requirements, triggering incident response.
- **Mitigation:**
  - Enable vault SDK redaction; scrub logs at source before persistence.
  - Run automated log scans detecting secret patterns.
  - Restrict access to rotation logs with RBAC and auditing.
- **Testing Focus:** Log sampling in staging; security reviews of logging configuration.

### 4. PERF-011: Service Reload After Rotation Causes Downtime
**Score:** 6 (High)

- **Probability:** Medium (2) – Services lacking hot-reload may restart abruptly when credentials refresh.
- **Impact:** High (3) – Interrupts generation, queue processing, or API availability.
- **Mitigation:**
  - Implement graceful reload hooks; coordinate rotation windows during low traffic.
  - Monitor availability metrics during rotation; auto-roll back if SLA breached.
  - Document service-specific behaviour and fallback plans.
- **Testing Focus:** Integration tests rotating secrets under load; monitoring availability alerts.

## Medium-Risk Items

### 5. BUS-010: Ownership & Emergency Procedures Unclear
**Score:** 4 (Medium)

- **Probability:** Medium (2) – Documentation of RACI and emergency response may lag.
- **Impact:** Medium (2) – Slow incident response and audit findings citing governance gaps.
- **Mitigation:**
  - Maintain RACI matrix with review cadence; require acknowledgements from owners each rotation cycle.
  - Run tabletop exercises covering emergency rotations and revoke scenarios.
  - Store sign-offs with evidence accessible to auditors.
- **Testing Focus:** Documentation reviews; compliance audits verifying ownership records.

## Risk Distribution

### By Category
- Security: 1 risk (1 critical)
- Operational: 1 risk (0 critical, 1 high)
- Data: 1 risk (0 critical, 1 high)
- Performance: 1 risk (0 critical, 1 high)
- Business: 1 risk (0 critical, 0 high, 1 medium)

### By Component
- Secret storage/vault integration: 1 risk
- Rotation automation: 1 risk
- Logging/sanitisation: 1 risk
- Service reload strategy: 1 risk
- Governance/documentation: 1 risk

## Risk Matrix

| Risk ID  | Description                                       | Probability | Impact | Score | Priority |
|----------|---------------------------------------------------|-------------|--------|-------|----------|
| SEC-011  | Secrets persist outside managed vault controls     | High (3)    | High (3) | 9   | Critical |
| OPS-015  | Rotation pipelines fail silently                   | Medium (2)  | High (3) | 6   | High     |
| DATA-014 | Rotation logs leak sensitive metadata              | Medium (2)  | High (3) | 6   | High     |
| PERF-011 | Service reload after rotation causes downtime      | Medium (2)  | High (3) | 6   | High     |
| BUS-010  | Ownership and emergency procedures unclear         | Medium (2)  | Medium (2) | 4 | Medium   |

## Detailed Risk Register

| Risk ID  | Category | Components Affected                 | Detection Method                                | Mitigation Owner      | Residual Risk |
|----------|----------|-------------------------------------|-------------------------------------------------|-----------------------|----------------|
| SEC-011  | Security | Repos, CI/CD, runtime secret config | Secret scanners, policy-as-code, audits         | Security Engineering  | Low with vault enforcement |
| OPS-015  | Operational | Rotation pipelines, schedulers   | Job telemetry, chaos drills                      | Platform Ops          | Medium – requires ongoing monitoring |
| DATA-014 | Data     | Logging pipeline, observability     | Log scans, security review                       | Security Engineering  | Medium – dependent on redaction discipline |
| PERF-011 | Performance | Services consuming secrets       | Rotation under load tests, availability metrics  | Platform Engineering  | Medium – needs continuous validation |
| BUS-010  | Business | Documentation, ownership records    | Compliance audits, tabletop exercises           | Compliance Office     | Low once governance enforced |

## Risk-Based Testing Strategy

### Priority 1: Critical & High Risks
- Secret scanning and policy enforcement tests (SEC-011).
- Rotation chaos drills and log redaction verification (OPS-015, DATA-014).
- Load tests validating hot-reload behaviour during rotations (PERF-011).

### Priority 2: Medium Risks
- Governance reviews ensuring ownership documentation accuracy (BUS-010).

### Priority 3: Baseline Regression
- Smoke tests confirming services can fetch secrets via vault; monitoring for rotation success events.

## Risk Acceptance Criteria

### Must Fix Before Production
- SEC-011 controls must prove all secrets flow through managed vaults.
- OPS-015/DATA-014 mitigations must demonstrate monitored automation and sanitized logs.

### Can Deploy with Mitigation
- PERF-011 acceptable with rotation playbooks, alerting, and tested hot-reload.
- BUS-010 acceptable if governance backlog is tracked and reviewed.

### Accepted Risks
- None accepted currently.

## Monitoring Requirements
- Track secret access audits, rotation success/failure metrics, and log redaction checks.
- Monitor service availability during rotations and escalate anomalies.

## Risk Review Triggers
- Addition of new third-party integrations or credentials.
- Pipeline/tooling changes affecting secret distribution.
- Security incidents or audit findings referencing secrets management.

## Recommendations Summary
- Enforce vault-only secret storage with automated scanning.
- Monitor rotation pipelines rigorously, ensuring logs remain sanitized.
- Keep governance documentation current to satisfy compliance reviews.

Risk profile: docs/qa/assessments/3.5-risk-20250926.md
